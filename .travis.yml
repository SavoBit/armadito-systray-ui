language: C
sudo: required
dist: trusty
addons:
  apt:
    packages:
    - libtool
    - libglib2.0-dev
    - libjson-c-dev
    - libcurl4-openssl-dev
    - gnome-common
    - libnotify-dev
    - libgtk-3-dev
    - libappindicator3-dev
  coverity_scan:
    project:
      name: armadito/armadito-systray-ui
      description: Build submitted via Travis CI
    notification_email: vhamon@teclib.com
    build_command_prepend: "./configure; make clean"
    build_command: make -j 4
    branch_pattern: coverity_scan
  sonarqube: true

env:
  global:
   - secure: "lGNnNxzaomzwfJTVBaEogFNLp5/GHpY0YO4EaFU28rCm0yE7smLXLbMB3qiZ1mpC6UGfRm+iMEL37QWOGx2KdAbxGXHnUcAIPUtLm1L9Tj2zfYdguKnTzecYC+JuZApEyLky2TjOcgewFukIUX1svIYidPCxjphD7kuY+gd6g+fPNIsXteeOeOPMOAMGNequELTSJ1V8iugsfYSqdUH3WnBO+ULsJP5dCheRlvz5VmzorD2U7eVz9ajEJ9aAuldSiOGd+OCWriebqnUfRkK2ppw/co39CFry0UanRGEIqotY8UOoIf+jNuOdHKM5TCc+4spl4+D96BVmZIyzixkz/5SyAEn1ALye/rl9Y6vNhf3Vv/f9PhyfExmmJdPKcY4xYK6AsXcj1hiNm/Pbhl3DtkzeFS4q/tPnmNNa2RQ6mqTCluhTCNkqetQPgRUqiXE30/rSgpZ5dm0MsypPYtyVEwrj/My/pdu4YwnOFYQ5ai4ZiN7Yt+XdJ26wwVcvkf/it4wRz4UgYNnFSXP4LVQ2iGB7O4Xws3IGF/k0TBGHb2MWElu0W8AYR+IxLvzt2/XebokCGSP2hgdZnOVOaDpBuubCq1oL+KiXJNtut2bDQlLncTg9984F3SGaBun54d96dyrngy9fWgRKx56H+wdA0l6Absw4RPQBmk7Qt82vCCw="
  - secure: "blMEmG81NnwBaasGjgb6yXS4d7sBQ1Z7pXUT9NvllnbHFG0BArsWi5S4wNfRZGeD+GFx/A3cmRswcgCZJ+jO6bNzHx6yuU9gpje9Fg5a6mocW8MYxd9A80B77fgQN630eYElNBN1f19uuGpHc53wE5bXdP5u4Hpl4hT9NBtBVwLDQcBeRm/Etw4evfIkv/kavL3EHtviZUkORoZQ8LGhaka57LjoCe5h6E2O3faTLWN6nCCr4pHh2xEva6APndpRm/dOTHpjGBl4MqydPOdmhcpppNGV1K6CS+PsMjLIBIZVCBf63zpGWlHf0wi5VLMTH/TWF4+hrTshLRbylnVkx5MQrVfctCLK51NR164onZ9WA8Fn+wDYDIRWfFgNpz985mxMQ61rdbiCzwwsmd3vCEac6yUyQe13SWda0oavby254dV+mb8KGZZCt5zwYw7dMBfJ1S/gNPU85u+AApiHy/SwaqzgZUAwhpvCvOeS5zhQu9CjGDCw2EOTx/gXFfHiQp8HvxRDM/QS2k5tpszHGsZD4SM3zRJew28IlEM1N7J/WwFcgOD3z5wLd7qbXfHGSJiINWMLhuc6dtiLV9MYTuGbCkMcpSmQfSGNLzG/Apoiet9FE+2gpvR/kzwsEePvQEnCuyyZiz3Q53fFxGXfpCC4quMeQvl9q+kS1q8rfno="

before_install:
- echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END
  CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-

compiler:
- gcc

before_script:
- cd gtk
- "./autogen.sh"

script:
- ./configure
- make clean all
- cd ../
- sonar-scanner -e -X -Dsonar.host.url=https://sonarqube.com -Dsonar.login=$SONAR_TOKEN
